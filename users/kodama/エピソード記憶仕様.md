 # エピソード記憶タスクテスト
- マーモセットが選択した図形を再入室時に同じものを選ぶことで報酬がもらえる課題（マーモセットが前日に木をかじり、翌朝、樹液を吸いに戻って来る習性を利用して、エピソード記憶を評価するためのテスト）

```plantuml
@startuml
' !theme cerulean
title Main

state "フローStart" as group.Operation {
    note top of group.Operation
    = 想定するマーモセットの動きのフロー
    - マーモセットが入室（RFID読み込み）
    - 画面に表示された図形のうち1つを選択してタッチ（選択時）
    - 少量の報酬を獲得 →通常量
    - 退室
    - 一定時間経過 →Interval Time
    - 再入室（RFID読み込み）
    - 画面に表示された図形のうち1つを選択（再入室時）
    - 正解の場合には大量の報酬獲得 or 不正解の場合には報酬なし
    endnote
    }
    [*] --> state.Init
    note left of state.Init
    = 設定パラメーター
    - 表示する図形の数
    - 表示する図形の位置、色、形
    - 再入室時の図形の位置、色、形を選択時と同じにするかどうか → 選択以外をランダムにできる
    - タイマー設定（例：前日の夕方に選択し、翌朝に再入室）
    - 再入室までの時間（タイマー設定無しの場合、1s~12hのうち任意の値を選択） → Interval Time
    - リセットまでの時間（タイマー設定無しの場合、1s~12hのうち任意の値を選択、この時間を超えるとはじめからやり直し）→ExpireTime
    - 報酬の量別
    - 条件外は通常DelayMatch
    - トリガー画像と背景色（別のタスクと異なるものを設定可能にしたい）→現在なし
    - 不正解時の挙動（報酬なしで次に or 不正解の場合は次に進まない） →現在なし

    endnote

    state "初期化" as state.Init {
        state.Init --> state.Idle
        'state.Init : exit / アプリケーション起動直後の設定
    }
    state "アイドル" as state.Idle {
        state.Idle --> state.EnterRoom : 入室
        state.Idle --> state.Idle : * 入室待機
        state.Idle : 入室待機
        
    }
    state "入室" as state.EnterRoom{
        note top of state.EnterRoom
        - マーモセットが入室（RFID読み込み）
        - 個体判別
        - Timer確認
        endnote
        
    }
    state choid <<choice>>
    state.EnterRoom --> choid
    choid --> state.FirstEntry : 開始 初入室
    choid --> state.ReEntry : 再入室
    choid --> state.DelayMatch: 条件外
    note top of choid
        エピソード記憶条件判断
    endnote 

state "初回課題" as group.FirstTest {
    state "課題表示" as state.FirstEntry {

    }
    state.FirstEntry --> state.Correct


    state "図形選択" as state.Correct {
        'state.Correct : hogehoge
        state.Correct --> state.B
        state.Correct : * ID 選択図形 表示図形座標保存
    }
}
state "再課題" as group.RepeatTest {
    state "課題表示" as state.ReEntry {
        state.ReEntry : * ID同一課題

    }
    state.ReEntry --> state.ReEntry : 不正解時
    state.ReEntry --> state.ReCorrect

    state "正解" as state.ReCorrect {
        state.ReCorrect --> state.NormalReward
        state.ReCorrect : * ID 正答保存
    }

}

    state "DelayMatch" as state.DelayMatch{
        state.DelayMatch : * 通常ディレイマッチ
        state.DelayMatch --> state.Exit
    }

state "報酬" as group.Reward {
    state "給餌" as state.B {
        state.B : *少量
    }
    state.B --> state.hgege
    state "給餌完了" as state.hgege {
        
    }
    state.hgege --> state.Exit
}

state "報酬" as group.ExReward {
    state "給餌" as state.NormalReward {
        state.NormalReward : *通常量

    }
    state.NormalReward --> state.aabii
    state "給餌完了" as state.aabii {
        
    }
    state.aabii --> state.Exit
}
state "退室" as group.Exit {
    state "exit" as state.Exit{
        state.Exit : 退室

    }
    state.Exit --> state.Idle
}



@enduml
```

   #  タスクのサンプルケース
        ケース1（最終ゴール）. 
        マーモセット3頭で飼育（マイクロチップID: AAA, BBB, CCC）し、タイマー設定ありの場合
        タイマー設定時間：選択16:00-19:00、再入室07:00-12:00
        1日目 07:00-16:00
        ID[AAA,BBB,CCC]が入室した場合、ディレイドマッチング課題を実施
        1日目 16:00-19:00
        ID[AAA]が入室し、エピソード課題を実施、星型の図形を選択する。
        ID[BBB]が入室し、エピソード課題を実施、四角型の図形を選択する。
        ID[AAA]が入室し、ディレイドマッチング課題を実施
        ID[CCC]が入室し、エピソード課題を実施、丸の図形を選択する。
        ID[CCC]が入室し、ディレイドマッチング課題を実施
        ２日目07:00-12:00
        ID[AAA]が入室し、エピソード課題の再入室後の工程を実施
        ID[CCC]が入室し、エピソード課題の再入室後の工程を実施
        ID[AAA]が入室し、ディレイドマッチング課題を実施
        ２日目12:00-16:00
        ID[AAA]が入室し、ディレイドマッチング課題を実施
        ID[BBB]が入室し、ディレイドマッチング課題を実施
        2日目16:00-19:00
        ID[BBB]が入室し、エピソード課題を実施、四角型の図形を選択する。
        ID[CCC]が入室し、エピソード課題を実施、丸の図形を選択する。
        ID[CCC]が入室し、ディレイドマッチング課題を実施
        3日目07:00-12:00
        ID[AAA]が入室し、ディレイドマッチング課題を実施
        ID[BBB]が入室し、エピソード課題の再入室後の工程を実施

        以下継続

        ケース2（トレーニング）. 
        マーモセット3頭で飼育（マイクロチップID: AAA, BBB, CCC）し、タイマー設定なし、再入室時間10分の場合
        9:00
        ID[AAA]が入室し、エピソード課題を実施、四角型の図形を選択する。
        9:10
        ID[AAA]が入室し、エピソード課題の再入室後の工程を実施
        9:15
        ID[AAA]が入室し、エピソード課題を実施、四角型の図形を選択する。
        9:20
        ID[BBB]が入室し、エピソード課題を実施、四角型の図形を選択する。
        9:23
        ID[AAA]が入室し、ディレイドマッチング課題を実施
        ID[CCC]が入室し、エピソード課題を実施、四角型の図形を選択する。

        9:27
        ID[AAA]が入室し、エピソード課題の再入室後の工程を実施
        12:00
        ID[BBB]が入室し、エピソード課題の再入室後の工程を実施
