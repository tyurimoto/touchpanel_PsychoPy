# ビルドとテストの手順（重要）

## 問題: 修正が反映されていません

error.md.txtのログを確認したところ、**私が追加したログが一切表示されていません**。
これは、**リビルドが正しく行われていない**ことを意味します。

---

## 必須手順: 正しいリビルド方法

### Step 1: ビルド構成を確認

Visual Studioのツールバーで、以下を確認してください：

```
[ビルド構成ドロップダウン] → 「DebugDummyIo」を選択
[プラットフォーム] → 「Any CPU」または「x64」
```

**重要**:
- **「Debug」ではありません**
- **「Release」でもありません**
- **「DebugDummyIo」を選択してください**

### Step 2: ソリューションのクリーン

```
メニューバー → ビルド → ソリューションのクリーン
```

待機して、出力ウィンドウで「クリーンが成功しました」を確認してください。

### Step 3: ソリューションのリビルド

```
メニューバー → ビルド → ソリューションのリビルド
```

**出力ウィンドウを確認**してください：

```
========== ビルド: 成功 1、失敗 0、最新の状態 0、スキップ 0 ==========
```

**「成功 1」と表示されていることを必ず確認してください。**

エラーや警告が表示された場合は、そのログを共有してください。

### Step 4: F5でデバッグ実行

**重要**:
- ❌ **exeファイルを直接ダブルクリックしないでください**
- ❌ **bin/DebugDummyIo/Compartment.exe を直接実行しないでください**
- ✅ **必ず Visual Studio から F5 キーを押してデバッグ実行してください**

または：
```
メニューバー → デバッグ → デバッグの開始 (F5)
```

---

## ビルド確認方法

### 確認1: 出力ウィンドウを開く

```
メニューバー → 表示 → 出力
または Ctrl + Alt + O
```

### 確認2: 起動時のログを確認

アプリケーションが起動したら、出力ウィンドウに以下のログが表示されるはずです：

```
=================================================
[BUILD VERIFICATION] FormMain_Load - ビルド日時: 2025-XX-XX XX:XX:XX
=================================================
デバッグモード（完全ダミー）で起動しました
```

**このログが表示されない場合、リビルドが正しく反映されていません。**

### 確認3: Startボタンを押す

Startボタンを押したら、以下のログが表示されるはずです：

```
[Idle] Start command received. EnableDebugMode=True
[Idle] eDoor enabled
[Idle] Transitioned to PreEnterCageProc
[PreEnterCageProc] BeforeState=Idle
[PreEnterCageProc] Transitioned to DeviceStandbyBegin
[DeviceStandbyBegin] EnableDebugMode=True
[デバッグモード] デバイススタンバイをスキップ
[デバッグモード] デバイススタンバイ完了
```

**これらのログが表示されない場合、リビルドが正しく反映されていません。**

---

## トラブルシューティング

### 問題1: ビルドが失敗する

出力ウィンドウで「ビルド: 失敗 1」と表示された場合：

1. エラー一覧ウィンドウを開く（表示 → エラー一覧）
2. エラーメッセージをコピー
3. error.md.txt に貼り付けて共有してください

### 問題2: ログが表示されない

起動時のログ `[BUILD VERIFICATION]` が表示されない場合：

1. **出力ウィンドウで「デバッグ」が選択されているか確認**
   - 出力ウィンドウ上部のドロップダウンで「デバッグ」を選択
2. **F5でデバッグ実行しているか確認**
   - exeを直接実行していないか確認
3. **ビルド構成が「DebugDummyIo」になっているか確認**

### 問題3: 古いexeが実行される

以下のフォルダを確認してください：

```
C:\Users\marmoset\Desktop\touch\touchpanel_PsychoPy\cs\Compartment\Compartment\bin\DebugDummyIo\
```

このフォルダ内の `Compartment.exe` のタイムスタンプが、**リビルド直後の時刻**になっているか確認してください。

もし古い日付のままなら、リビルドが失敗しています。

---

## 次のテスト

上記の手順でリビルドとデバッグ実行を行った後：

1. 出力ウィンドウで `[BUILD VERIFICATION]` ログを確認
2. Startボタンを押す
3. 出力ウィンドウで `[Idle]`, `[PreEnterCageProc]`, `[DeviceStandbyBegin]` のログを確認
4. **出力ウィンドウの全内容**を error.md.txt に保存して共有してください

---

## 重要なポイント

- ✅ ビルド構成: **DebugDummyIo**
- ✅ リビルド: **ソリューションのクリーン → ソリューションのリビルド**
- ✅ 実行方法: **F5 でデバッグ実行**
- ✅ 確認方法: **出力ウィンドウで `[BUILD VERIFICATION]` ログを確認**

この手順を正確に実行すれば、修正が正しく反映されます。
